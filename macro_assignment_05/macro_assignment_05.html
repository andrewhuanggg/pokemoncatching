<!doctype html>
<html>
  <head>
    <title>Macro Assignment 05</title>
    <style>
      body {
        background-image: url('images/corkboard.jpg');
      }
      #add_button {
        position: fixed;
        bottom: 20px;
        right: 20px;
      }
      #filter_container {
        position: fixed;
        top: 20px;
        right: 20px;
      }

      .hidden {
        display: none;
      }

      #input_panel {
        width: 500px;
        height: 500px;
        background-color: #fff;
        border-radius: 15px;
        box-sizing: border-box;
        padding: 20px;
        position: absolute;
        top: 50%;
        left: 50%;
        margin-left: -250px;
        margin-top: -250px;
      }
      #item_panel {
        width: 500px;
        height: 500px;
        background-color: #fff;
        border-radius: 15px;
        box-sizing: border-box;
        padding: 20px;
        position: absolute;
        top: 50%;
        left: 50%;
        margin-left: -250px;
        margin-top: -250px;
      }

      .item {
        width: 100px;
        height: 100px;
        float: left;
        position: relative;
      }

      .winter {
        background-color: blue;
      }
      .spring {
        background-color: yellow;
      }
      .summer {
        background-color: orange;
      }
      .fall {
        background-color: brown;
      }
      .postItSpace {
        margin-right: 10px;
        
      }

      .postItDelete {
        position: absolute;
        top: 0px;
        right: 0px;
      }

      .itemTitleFormat {
        font-weight: bold;
        font-size: 24px;
      }

      .completeCheckbox {
        position: absolute;
        bottom: 0px;
        left: 0px;
        width: 20px;
        height:20px;
      }

      .completeButton {
        position: absolute;
        bottom: 0px;
        right: 0px
      }

       .leftButton {
        position: absolute;
        left: 0px;
        top: 40px;
      }

      .rightButton {
        position: absolute;
        right: 0px;
        top: 40px;
      }

      #headerNewItem {
        font-weight: bold;
        font-size: 24px;
      }

      .hiddenBox {
        width: 455px;
        height: 30px;
        background-color: red;
        text-align: center;
        color: white;
      }
      
      body {

      }



    </style>
  </head>
  <body>
    <h1 style="text-align:center">Seasonal To-Do List</h1>
    <img id="add_button" src="images/add_button.png" width="60" height="60">
    <div id="filter_container">
      <select id="filter">
        <option value="all">All seasons</option>
        <option value="spring">Spring</option>
        <option value="summer">Summer</option>
        <option value="fall">Fall</option>
        <option value="winter">Winter</option>
        <option value="complete">Complete</option>
        <option value="incomplete">Incomplete</option>
      </select>
    </div>

    <div id="input_panel" class="hidden">
      <div id = headerNewItem> Add New Item </div>
      <br>
      <div id="error" class="hidden">Please fill out the form!</div>
      <div>
        <label for="title">Title</label><br>
        <input type="text" id="title" style = "width: 450px;">
      </div>
      <br>
      <div>
        <label for="category">Category</label><br>
        <select id="category" style = "width: 460px;">
          <option value="spring">Spring</option>
          <option value="summer">Summer</option>
          <option value="fall">Fall</option>
          <option value="winter">Winter</option>     
        </select>
      </div>
      <br>
      <div>
        <label for="description">Description</label><br>
        <textarea style = "resize:none; width:455px; height:80px;" id="description" ></textarea>
      </div>
      <button id="cancel">Cancel</button>
      <button id="save">Save</button>
    </div>
    <div id="item_panel" class="hidden">
      <div id=item_title>Title</div>
      <br>
      <div id="item_description">Nothing</div>
      <hr>
      <div id="item_creation_time">Nothing</div>
      <div id="item_access_time">Nothing </div>
      <br>
      <button id="item_panel_close">Close</button>
    </div>
    <div id="board"></div>


    <script>
      const add_button = document.getElementById('add_button');
      const input_panel = document.getElementById('input_panel'); //panel for creating a new post it
      const title = document.getElementById('title');
      const category = document.getElementById('category');
      const description = document.getElementById('description');
      const cancel = document.getElementById('cancel');
      const save = document.getElementById('save');
      const error = document.getElementById('error');
      const board = document.getElementById('board');
      const seasonal_selector = document.getElementById('filter');
      const item_panel_close_button = document.getElementById('item_panel_close')

      var input_panel_title = document.getElementById("title")
      var input_panel_desc = document.getElementById("description")
      var input_panel_cat = document.getElementById("category")

      const item_panel = document.getElementById("item_panel") // info panel when you click on an existing post it
      var item_description = item_panel.querySelector("#item_description")
      var item_title = item_panel.querySelector("#item_title")
      var item_creation_time = item_panel.querySelector("#item_creation_time")
      var item_access_time = item_panel.querySelector("#item_access_time")

     

      add_button.onclick = function(event) {
        input_panel.classList.remove('hidden');
        error.classList.add('hidden');
      }

      add_button.onmouseover = function(event) {
        console.log("add button mouseover")
        add_button.width=100
        add_button.height=100
      }

      add_button.onmouseout = function(event) {
        console.log("add button mouseleave")
        add_button.width = 60
        add_button.height = 60
      }

      //closes the post it note info panel
      item_panel_close_button.onclick = function(event) {
        item_panel.classList.add("hidden")
      }
      
      //cancels creation of post it note.
      cancel.onclick = function(event) {
        input_panel_title.value = ""
        input_panel_desc.value = ""
        input_panel.classList.add('hidden');
      }

      save.onclick = function(event) {
        if (description.value && title.value && category.value) {
          // yay!

          // build a post it note
          let tempDiv = document.createElement('div'); // Post it note parent node
          let tempDes = document.createElement('div');
          let tempCreationTime = document.createElement('div')
          let tempTitle = document.createElement('div')

          //construct post it parent
          tempDiv.classList.add('item');
          tempDiv.classList.add( category.value );
          tempDiv.classList.add('postItSpace')
          tempDiv.style.positon = 'relative'
          tempDiv.innerHTML = title.value; // display task title

          //Make invisible div children to store information in
          tempTitle.innerHTML = title.value
          tempTitle.classList.add("hidden")
          tempTitle.id = "taskTitle"
          tempDiv.appendChild(tempTitle)

          tempDes.innerHTML = description.value
          tempDes.classList.add("hidden")
          tempDes.id = "taskDescription"
          tempDiv.appendChild(tempDes)

          currentTime = new Date()
          tempCreationTime.innerHTML = currentTime.toLocaleString()
          tempCreationTime.classList.add("hidden")
          tempCreationTime.id = "taskCreationTime"
          tempDiv.appendChild(tempCreationTime)

          let imgHolder = document.createElement('div')
          imgHolder.classList.add("postItDelete")
          let img = document.createElement('img')
          img.src = 'images/delete_button.png'
          //img.style.position = 'relative'
          img.classList.add("hidden")
          img.classList.add('postItDelete')
          img.id = "postItDelete"
          img.onclick = function(event) {
            this.parentNode.remove()
            event.stopPropagation()
          }
          imgHolder.appendChild(img)
          tempDiv.appendChild(imgHolder)

          let completeButton = document.createElement('button')
          completeButton.type = "button"
          completeButton.innerHTML = "Complete"
          completeButton.classList.add("completeButton")
          
          let completeCheck = document.createElement('div')
          completeCheck.classList.add("completeCheckbox")
          completeCheck.classList.add("hidden")
          let completeImg = document.createElement('img')
          completeImg.src = "images/checkbox.webp"
          completeImg.classList.add("completeCheckbox")
          completeCheck.appendChild(completeImg)

         completeButton.onclick = function(event) {
            console.log("Complete button clicked")
            if(this.parentNode.classList.contains("incomplete")) {
              this.parentNode.querySelector(".completeCheckbox").classList.remove("hidden")
              this.parentNode.classList.remove("incomplete")
              this.parentNode.classList.add("complete")
            }
            else if(this.parentNode.classList.contains("complete")) {
              this.parentNode.querySelector(".completeCheckbox").classList.add("hidden")
              this.parentNode.classList.add("incomplete")
              this.parentNode.classList.remove("complete")
            }
            event.stopPropagation()
          }

          tempDiv.classList.add("incomplete")
          tempDiv.appendChild(completeButton)
          tempDiv.appendChild(completeCheck)

         let rightArrowHolder = document.createElement('div')
          rightArrowHolder.classList.add("rightButton")
          let rightArrowImg = document.createElement('img')
          rightArrowImg.src = "images/right_button.png"
          rightArrowHolder.appendChild(rightArrowImg)
          rightArrowHolder.onclick = function(event) {
            console.log("Right Arrow clicked")
            console.log(this)
            console.log(this.nextSibling)
            console.log(this.parentNode.parentNode)
            console.log(this.parentNode.parentNode.children)
            currentPostIt = this.parentNode
            postItContainer = this.parentNode.parentNode
            postItContainer.insertBefore(currentPostIt, currentPostIt.nextSibling.nextSibling)
            event.stopPropagation()
            if(currentPostIt.nextSibling == null) {
              this.classList.add("hidden")
              currentPostIt.previousSibling.querySelector(".rightButton").classList.remove("hidden")
            }

            let allItems = document.querySelectorAll(".item")
            for(var i = 0; i < allItems.length; i++) {
              if(allItems[i].nextSibling) {
                allItems[i].querySelector(".rightButton").classList.remove("hidden")
              } 
              else {
                allItems[i].querySelector(".rightButton").classList.add("hidden")
              }

              if(allItems[i].previousSibling) {
                allItems[i].querySelector(".leftButton").classList.remove("hidden")
              }
              else {
                allItems[i].querySelector(".leftButton").classList.add("hidden")
              }
            }
          }
          tempDiv.appendChild(rightArrowHolder)

          let leftArrowHolder = document.createElement('div')
          leftArrowHolder.classList.add("leftButton")
          let leftArrowImg = document.createElement('img')
          leftArrowImg.src = "images/left_button.png"
          leftArrowHolder.appendChild(leftArrowImg)
          leftArrowHolder.onclick = function(event) {
            console.log("left Arrow clicked")
            console.log(this)
            console.log(this.nextSibling)
            console.log(this.parentNode.parentNode)
            console.log(this.parentNode.parentNode.children)
            currentPostIt = this.parentNode
            postItContainer = this.parentNode.parentNode
            postItContainer.insertBefore(currentPostIt, currentPostIt.previousSibling)
            event.stopPropagation()
            if(currentPostIt.previousSibling == null) {
              this.classList.add("hidden")
              currentPostIt.nextSibling.querySelector(".leftButton").classList.remove("hidden")
            }
            
            let allItems = document.querySelectorAll(".item")
            for(var i = 0; i < allItems.length; i++) {
              if(allItems[i].nextSibling) {
                allItems[i].querySelector(".rightButton").classList.remove("hidden")
              } 
              else {
                allItems[i].querySelector(".rightButton").classList.add("hidden")
              }

              if(allItems[i].previousSibling) {
                allItems[i].querySelector(".leftButton").classList.remove("hidden")
              }
              else {
                allItems[i].querySelector(".leftButton").classList.add("hidden")
              }
            }
          }
          tempDiv.appendChild(leftArrowHolder)


          // have each of our little notes listen for mouse events
          tempDiv.onclick = function(event) {
            console.log("you clicked on the div!");
            console.log(this.querySelector("#taskDescription").innerHTML)
            item_title.innerHTML = this.querySelector("#taskTitle").innerHTML
            //item_title.style.fontWeight = 'bold';
            item_title.classList.add('itemTitleFormat')
            if(event.currentTarget.classList.contains('fall')){
              item_description.innerHTML = "Season: Fall <br>"
            }

            if(event.currentTarget.classList.contains('winter')){
              item_description.innerHTML = "Season: Winter <br>"
            }

            if(event.currentTarget.classList.contains('spring')){
              item_description.innerHTML = "Season: Spring <br>"
            }

            if(event.currentTarget.classList.contains('summer')){
              item_description.innerHTML = "Season: Summer <br>"
            }
            //item_desciprtion.innerHTML = 
            item_description.innerHTML += this.querySelector("#taskDescription").innerHTML

            item_creation_time.innerHTML = "Created: "
            item_creation_time.innerHTML += this.querySelector("#taskCreationTime").innerHTML
            
            let currentTime = new Date()

            item_access_time.innerHTML = "Last Accessed: "
            
            item_access_time.innerHTML += currentTime.toLocaleString() 

            item_panel_close_button.style.textAlign = 'center'
            console.log(item_panel_close_button.style.textAlign)
            this.querySelector("#postItDelete").classList.add("hidden")
            item_panel.classList.remove("hidden")
          }

          tempDiv.onmouseover = function(event) {
            console.log("Post it hovered over")
            this.querySelector("#postItDelete").classList.remove("hidden")
          }
          tempDiv.onmouseout = function(event) {
            console.log("leaving post it")
            this.querySelector("#postItDelete").classList.add("hidden")
          }
          // set filter to all
          var postIts = document.querySelectorAll('.item')
          for(var i=0; i < postIts.length; i++) {
            postIts[i].classList.remove("hidden")
          }
          seasonal_selector.value = "all"
          

          // add to the board
          board.appendChild(tempDiv);

          //adjust arrow visibility
          if(tempDiv.nextSibling == null) {
            rightArrowHolder.classList.add("hidden")
          }

          if(tempDiv.previousSibling == null) {
            leftArrowHolder.classList.add("hidden")
          }
          else {
            tempDiv.previousSibling.querySelector(".rightButton").classList.remove("hidden")
          }


          //Change fields back to default
          input_panel_title.value = ""
          input_panel_desc.value = ""
          input_panel_cat.value = "spring"
          // hide the input panel
          input_panel.classList.add("hidden");


        }
        else {
          // sad :(
          error.classList.remove('hidden');
          error.classList.add('hiddenBox')
        }
      }

      seasonal_selector.onclick = function(event) {
        selected_season = seasonal_selector.value
        var postIts = document.querySelectorAll('.item')
        var springPostIts = document.querySelectorAll('.spring')
        var summerPostIts = document.querySelectorAll('.summer')
        var fallPostIts = document.querySelectorAll('.fall')
        var winterPostIts = document.querySelectorAll('.winter')
        var completePostIts = document.querySelectorAll('.complete')
        var incompletePostIts = document.querySelectorAll('.incomplete')

        console.log("Season Selected")
        console.log(selected_season)
        
        if (selected_season === "all") {
          console.log("ALL SEASON")
          for(var i=0; i < postIts.length; i++) {
            postIts[i].classList.remove("hidden")
          }
        }
        else {
          if(selected_season === "spring") {
            console.log("SPRING")
            for(var i=0; i < springPostIts.length; i++) {
              springPostIts[i].classList.remove("hidden")
            }
            for(var i=0; i < summerPostIts.length; i++) {
              summerPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < fallPostIts.length; i++) {
              fallPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < winterPostIts.length; i++) {
              winterPostIts[i].classList.add("hidden")
            }
          }
          else if (selected_season == "summer") {
            console.log("SUMMER")
            for(var i=0; i < springPostIts.length; i++) {
              springPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < summerPostIts.length; i++) {
              summerPostIts[i].classList.remove("hidden")
            }
            for(var i=0; i < fallPostIts.length; i++) {
              fallPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < winterPostIts.length; i++) {
              winterPostIts[i].classList.add("hidden")
            }
          }
          else if (selected_season == "fall") {
            for(var i=0; i < springPostIts.length; i++) {
              springPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < summerPostIts.length; i++) {
              summerPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < fallPostIts.length; i++) {
              fallPostIts[i].classList.remove("hidden")
            }
            for(var i=0; i < winterPostIts.length; i++) {
              winterPostIts[i].classList.add("hidden")
            }

          }
          else if (selected_season == "winter") {
            for(var i=0; i < springPostIts.length; i++) {
              springPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < summerPostIts.length; i++) {
              summerPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < fallPostIts.length; i++) {
              fallPostIts[i].classList.add("hidden")
            }
            for(var i=0; i < winterPostIts.length; i++) {
              winterPostIts[i].classList.remove("hidden")
            }
          }
          else if (selected_season == "complete") {
            console.log("FILTERING COMPLETE")
            for(var i=0; i < completePostIts.length; i++) {
              completePostIts[i].classList.remove("hidden")
            }
            for(var i=0; i < incompletePostIts.length; i++) {
              incompletePostIts[i].classList.add("hidden")
            }
          }
          else if (selected_season == "incomplete") {
            console.log("FILTERING INCOMPLETE")
            for(var i=0; i < completePostIts.length; i++) {
              completePostIts[i].classList.add("hidden")
            }
            for(var i=0; i < incompletePostIts.length; i++) {
              incompletePostIts[i].classList.remove("hidden")
            }
          }
        }
      }




    </script>

  </body>
</html>